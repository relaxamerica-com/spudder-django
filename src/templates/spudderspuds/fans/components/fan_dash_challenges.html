{% load featuretags %}

{% if challenge_participations %}

{#    <div class="list-group">#}
{#        {% for challenge in challenges %}#}
{#            {% if challenge %}#}
{#                {% if "challenge_management"|feature_is_enabled %}#}
{#                    <div class="list-group-item">#}
{#                        <h4 class="list-group-item-heading">#}
{#                            <a href="{{ challenge.link }}">{{ challenge.name }}</a>#}
{#                            {{ challenge.state|safe }}#}
{#                        </h4>#}
{#                        <div class="btn-group" id="{{ challenge.id }}">#}
{#                            {{ challenge.manage|safe }}#}
{#                        </div>#}
{#                    </div>#}
{#                {% else %}#}
{#                    <a href="{{ challenge.link }}" class="list-group-item">#}
{#                        <h4 class="list-group-item-heading">#}
{#                            {{ challenge.name }}#}
{#                            {{ challenge.state|safe }}#}
{#                            {{ challenge.created|safe }}#}
{#                        </h4>#}
{#                    </a>#}
{#                {% endif %}#}
{#            {% endif %}#}
{#        {% endfor %}#}
{#    </div>#}

    <div class="list-group">
        {% for challenge in challenge_participations %}
            <div class="list-group-item">
                <div class="media">
                    <span class="fa fa-stack text-primary media-object pull-left fa-2x">
                        <i class="fa fa-circle fa-stack-2x"></i>
                        <i class="fa fa-stack-1x fa-inverse fa-trophy"></i>
                    </span>
                    <div class="media-body">
                        <h4 class="media-heading">{{ challenge.challenge.name }} for {{ challenge.challenge.get_recipient.name }}</h4>
                        {% if challenge.state_engine == "accept-and-pledge" %}
                            {% if challenge.state_engine_state == accept_and_pledge_states.NOTICE %}
                                <p>
                                    <span class="label label-warning">Awaiting video</span>
                                </p>
                                <p>
                                    Do you have your video ready? <a href="/challenges/{{ challenge.challenge.id }}/{{ challenge.state_engine }}">go to the challenge</a>
                                </p>
                            {% endif %}
                            {% if challenge.state_engine_state == accept_and_pledge_states.UPLOAD_THANKS %}
                                <p>
                                    <span class="label label-success">Video posted</span>
                                </p>
                                <p>
                                    Are you ready to <a href="/challenges/{{ challenge.challenge.id }}/{{ challenge.state_engine }}">challenge others</a>?
                                </p>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

{% else %}

    <div class="well" style="width:90%; margin:20px auto;">
        <h4>You haven't started any challenges.</h4>
    </div>

{% endif %}