{% extends 'base.html' %}

{% block scripts %}
	<script type="text/javascript">
		function register() {
			var email = $('#mySignup #inputEmail').val(), 
				password1 = $('#mySignup #inputSignupPassword').val(), 
				password2 = $('#mySignup #inputSignupPassword2').val();
			var response = $.post('/accounts/register/', { 'email' : email, 'password1' : password1, 'password2' : password2 });
			response.done(function() {
				$('#mySignup').modal('hide');
				$('#mySignupComplete').modal('show');
			});
			response.fail(function(data) {
				$.each(JSON.parse(data.responseText), function(k, v) {
					var input = $('#mySignup input[name="' + k + '"]');
					var span = $('span[for="' + k + '"]');
					span.html(v);
					input.addClass('error');
				});
			});
		}
		
		function login() {
			var email = $('#mySignin #inputText').val(), 
			password = $('#mySignin #inputSigninPassword').val();
			var response = $.post('/accounts/login/', { 'username' : email, 'password' : password });
			response.done(function() {
				$('#mySignin').modal('hide');
				document.location = '/';
			});
			response.fail(function(data) {
				$.each(JSON.parse(data.responseText), function(k, v) {
					var span = $('span[for="' + k + '"]');
					span.html(v);
				});
			});
		}
	
		$(document).ready(function() {
			$('input').on('keydown', function() {
				$(this).removeClass('error');
			});
			
			{% if registration_activation_complete %}
				$('#activationComplete').modal('show');
			{% endif %}
			
			$('#mySignin-after-activation').click(function() {
				$('#activationComplete').modal('hide');
				$('#mySignupComplete').modal('hide');
			});
		});
	</script>	
{% endblock %}

{% block content %}

<div id="home">
	<div id="mySignupComplete" class="modal styled hide fade" tabindex="-1" role="dialog" aria-labelledby="mySignupModalLabel" aria-hidden="true">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
			<h4 id="mySignupModalLabel">Sign Up <strong>Complete</strong></h4>
		</div>
		<div class="modal-body">
			Registration was successful. Activation link has been sent to your e-mail address.
		</div>
	</div>
	
	<div id="activationComplete" class="modal styled hide fade" tabindex="-1" role="dialog" aria-labelledby="mySignupModalLabel" aria-hidden="true">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
			<h4 id="mySignupModalLabel">Activation <strong>Complete</strong></h4>
		</div>
		<div class="modal-body">
			Your account has been succesfuly activated. You can <b><a data-toggle="modal" href="#mySignin" id="mySignin-after-activation">login</a></b> now.
		</div>
	</div>

	<!-- Signup Modal -->
	<div id="mySignup" class="modal styled hide fade" tabindex="-1" role="dialog" aria-labelledby="mySignupModalLabel" aria-hidden="true">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
			<h4 id="mySignupModalLabel">Create an <strong>account</strong></h4>
		</div>
		<div class="modal-body">
			<form class="form-horizontal" action="/accounts/register/" method="POST">
			
				<span class="all-errors errors" for="__all__"></span>
				
				<div class="control-group">
					<label class="control-label" for="inputEmail">Email</label>
					<div class="controls">
						<input type="text" id="inputEmail" placeholder="Email" name="email">
						<span class="help-inline errors" for="email"></span>
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="inputSignupPassword">Password</label>
					<div class="controls">
						<input type="password" id="inputSignupPassword" placeholder="Password" name="password1">
						<span class="help-inline errors" for="password1"></span>
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="inputSignupPassword2">Confirm Password</label>
					<div class="controls">
						<input type="password" id="inputSignupPassword2" placeholder="Password" name="password2">
						<span class="help-inline errors" for="password2"></span>
					</div>
				</div>
				<div class="control-group">
					<div class="controls">
						<a href="javascript:register()" class="btn">Sign up</a>
					</div>
					<p class="aligncenter margintop20">
						Already have an account? <a href="#mySignin" data-dismiss="modal" aria-hidden="true" data-toggle="modal">Sign in</a>
					</p>
				</div>
			</form>
		</div>
	</div>
	<!-- end signup modal -->
	<!-- Sign in Modal -->
	<div id="mySignin" class="modal styled hide fade" tabindex="-1" role="dialog" aria-labelledby="mySigninModalLabel" aria-hidden="true">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
			<h4 id="mySigninModalLabel">Login to your <strong>account</strong></h4>
		</div>
		<div class="modal-body">
			<form class="form-horizontal" action="/accounts/login/" method="POST">
				{% csrf_token %}
				
				<span class="all-errors errors" for="__all__"></span>
				
				<div class="control-group">
					<label class="control-label" for="inputText">E-mail</label>
					<div class="controls">
						<input type="text" id="inputText" placeholder="Username" name="username">
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="inputSigninPassword">Password</label>
					<div class="controls">
						<input type="password" id="inputSigninPassword" placeholder="Password" name="password">
					</div>
				</div>
				<div class="control-group">
					<div class="controls">
						<a href="javascript:login()" type="submit" class="btn">Sign in</a>
					</div>
					<p class="aligncenter margintop20">
						Forgot password? <a href="#myReset" data-dismiss="modal" aria-hidden="true" data-toggle="modal">Reset</a>
					</p>
				</div>
			</form>
		</div>
	</div>
	<!-- end signin modal -->
	<!-- Reset Modal -->
	<div id="myReset" class="modal styled hide fade" tabindex="-1" role="dialog" aria-labelledby="myResetModalLabel" aria-hidden="true">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
			<h4 id="myResetModalLabel">Reset your <strong>password</strong></h4>
		</div>
		<div class="modal-body">
			<form class="form-horizontal">
				<div class="control-group">
					<label class="control-label" for="inputResetEmail">Email</label>
					<div class="controls">
						<input type="text" id="inputResetEmail" placeholder="Email">
					</div>
				</div>
				<div class="control-group">
					<div class="controls">
						<button type="submit" class="btn">Reset password</button>
					</div>
					<p class="aligncenter margintop20">
						We will send instructions on how to reset your password to your inbox
					</p>
				</div>
			</form>
		</div>
	</div>
	<!-- end reset modal -->

	{% include 'home/parts/slider.html' %}

	{% include 'home/parts/callaction.html' %}
	
	{% include 'home/parts/content.html' %}
	<section id="bottom">
	<div class="container">
		<div class="row">
			<div class="span12">
				<div class="aligncenter">
					<div id="twitter-wrapper">
						<div id="twitter">
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	</section>
</div>

{% endblock %}